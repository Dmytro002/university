<databaseChangeLog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">


    <changeSet id="17-10-2024-001" author="Dmytro Svirniuk">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="lectors"/>
            </not>
        </preConditions>

        <createTable tableName="lectors">
            <column name="id" type="bigint">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="salary" type="double">
                <constraints nullable="false"/>
            </column>
            <column name="degree" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="17-10-2024-002" author="Dmytro Svirniuk">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="departments"/>
            </not>
        </preConditions>

        <createTable tableName="departments">
            <column name="id" type="bigint" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="head_of_department_id" type="bigint"/>
        </createTable>

        <addForeignKeyConstraint
                constraintName="fk_departments_head_of_department"
                baseTableName="departments"
                baseColumnNames="head_of_department_id"
                referencedTableName="lectors"
                referencedColumnNames="id"/>
    </changeSet>

    <changeSet id="17-10-2024-003" author="Dmytro Svirniuk">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="lector_department"/>
            </not>
        </preConditions>

        <createTable tableName="lector_department">
            <column name="department_id" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="lector_id" type="bigint">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint
                constraintName="fk_lector_department_department"
                baseTableName="lector_department"
                baseColumnNames="department_id"
                referencedTableName="departments"
                referencedColumnNames="id"/>

        <addForeignKeyConstraint
                constraintName="fk_lector_department_lector"
                baseTableName="lector_department"
                baseColumnNames="lector_id"
                referencedTableName="lectors"
                referencedColumnNames="id"/>
    </changeSet>

    <changeSet id="17-10-2024-004" author="Dmytro Svirniuk">
        <insert tableName="lectors">
            <column name="id" valueNumeric="1"/>
            <column name="name" value="John Doe"/>
            <column name="salary" valueNumeric="50000"/>
            <column name="degree" value="ASSISTANT"/>
        </insert>
        <insert tableName="lectors">
            <column name="id" valueNumeric="2"/>
            <column name="name" value="Jane Smith"/>
            <column name="salary" valueNumeric="55000"/>
            <column name="degree" value="ASSOCIATE_PROFESSOR"/>
        </insert>
        <insert tableName="lectors">
            <column name="id" valueNumeric="3"/>
            <column name="name" value="Emily Johnson"/>
            <column name="salary" valueNumeric="60000"/>
            <column name="degree" value="PROFESSOR"/>
        </insert>
    </changeSet>

    <changeSet id="17-10-2024-005" author="Dmytro Svirniuk">
        <insert tableName="departments">
            <column name="id" valueNumeric="1"/>
            <column name="name" value="Computer Science"/>
            <column name="head_of_department_id" valueNumeric="1"/>
        </insert>
        <insert tableName="departments">
            <column name="id" valueNumeric="2"/>
            <column name="name" value="Mathematics"/>
            <column name="head_of_department_id" valueNumeric="2"/>
        </insert>
    </changeSet>

    <changeSet id="17-10-2024-006" author="Dmytro Svirniuk">
        <insert tableName="lector_department">
            <column name="department_id" valueNumeric="1"/>
            <column name="lector_id" valueNumeric="1"/>
        </insert>
        <insert tableName="lector_department">
            <column name="department_id" valueNumeric="1"/>
            <column name="lector_id" valueNumeric="2"/>
        </insert>
        <insert tableName="lector_department">
            <column name="department_id" valueNumeric="2"/>
            <column name="lector_id" valueNumeric="2"/>
        </insert>
        <insert tableName="lector_department">
            <column name="department_id" valueNumeric="2"/>
            <column name="lector_id" valueNumeric="3"/>
        </insert>
    </changeSet>


</databaseChangeLog>